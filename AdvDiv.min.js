function advdiv(r,e,a,t,f,n){var i=false,p=false;var s=0,I=0,g=-1,u,v,$;var h="",x;var E;var R=[];var d;var M,l,o,w,c;var m,b,j;var k;var q;RegExp.escape=r=>r.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&");if(!a&&a!=="")a="-";if(!t&&t!=="")t=".";if(!f&&f!=="")f="[";if(!n&&n!=="")n="]";if(r.length==0||e.length==0||/^\d*$/.test(a)||/^\d*$/.test(t)||/^\d*$/.test(f)||/^\d*$/.test(n))return false;q=new RegExp("^("+RegExp.escape(a)+")?\\d*("+RegExp.escape(t)+"\\d*("+RegExp.escape(f)+"\\d*"+RegExp.escape(n)+")?)?$");if(!q.test(r)||!q.test(e))return false;if(r.slice(0,a.length)==a){r=r.slice(a.length);i=true}if(e.slice(0,a.length)==a){e=e.slice(a.length);i=!i}m=i?a:"";r=r.replace(t,".");e=e.replace(t,".");if(r[0]==".")r="0"+r;if(e[0]==".")r="0"+e;r1=(new RegExp(RegExp.escape(f)+"(.+)"+RegExp.escape(n)).exec(r)||["0","0"])[1];r=r.split(f)[0].replace(/^0+/,"0").replace(r1=="0"?/\.0*$/:/\.*/,"");r2=(new RegExp(RegExp.escape(f)+"(.+)"+RegExp.escape(n)).exec(e)||["0","0"])[1];e=e.split(f)[0].replace(/^0+/,"0").replace(r2=="0"?/\.0*$/:/\.*/,"");if(e=="0"&&/^[0\.]+$/.test(r2))return false;if(r=="0"&&/^[0\.]+$/.test(r1))return"0";if(r2!="0"){b=r.replace(".","");j=e.replace(".","");l=parseInt(b+r1)-parseInt(b);o=parseInt(j+r2)-parseInt(j);if(r.indexOf(".")>-1)w=Math.pow(10,r.length-r.indexOf(".")-1+r1.toString().length)-Math.pow(10,r.length-r.indexOf(".")-1);else w=Math.pow(10,r1.toString().length)-1;if(e.indexOf(".")>-1)c=Math.pow(10,e.length-e.indexOf(".")-1+r2.toString().length)-Math.pow(10,e.length-e.indexOf(".")-1);else c=Math.pow(10,r2.toString().length)-1;return m+advdiv((l*c).toString(),(w*o).toString(),a,t,f,n)}E=function(r){if(r.indexOf(".")>-1&&r.indexOf(".")==r.length-2)return r.replace(".","");if(r.indexOf(".")>-1)return r.split(".")[0]+r.split(".")[1].split("")[0]+"."+r.split(".")[1].slice(1);return r+"0"};while(e.indexOf(".")>-1){if(r.indexOf(".")<0){r+=r1.toString()[0];if(r1.toString().length>1)r1=parseInt(r1.toString().slice(1)+r1.toString()[0])}else r=E(r);e=E(e)}M=parseInt(e);d=r.split("");k=r.split(".")[0].split("");for(u=0;u<k.length;u++){$=Math.floor((parseInt(E(s.toString()))+parseInt(k[u]))/M);h+=$.toString();s=parseInt(E(s.toString()))+parseInt(k[u])-M*$}if(h==""){h="0";u++}h+=".";if(d.indexOf(".")<0)d.push(".");for(u++;u==u;u++){if(u>=d.length){g++;p=true;d.push(parseInt(r1.toString().split("")[g%r1.toString().length]))}I=parseInt(E(s.toString()))+parseInt(d[u])-M*Math.floor((parseInt(E(s.toString()))+parseInt(d[u]))/M);if(p){if(I==0&&r1==0){h+=Math.floor((parseInt(E(s.toString()))+parseInt(d[u]))/M).toString();return m+h.replace(/^0+|0$/gm,"").replace(/^\./,"0.").replace(/\.$/,"").replace(".",t)}for(v=0;v<R.length;v++){if(p&&R[v]==I&&v%r1.toString().length==(g+1)%r1.toString().length){h+=Math.floor((parseInt(E(s.toString()))+parseInt(d[u]))/M).toString();x=m+(h.slice(0,u-g+v)+"["+h.slice(u-g+v)+"]").replace(/^0+/gm,"").replace(/^\./,"0.");if(x[x.indexOf("[")-1]==x[x.indexOf("]")-1])x=x.slice(0,x.indexOf("[")-1)+"["+x[x.indexOf("[")-1]+x.slice(x.indexOf("[")+1,x.indexOf("]")-1)+"]";if(x.indexOf("]")==x.indexOf("[")+3&&x[x.indexOf("[")+1]==x[x.indexOf("[")+2])x=x.slice(0,x.indexOf("[")+2)+"]";return x.replace(".",t).replace("[",f).replace("]",n)}}}h+=Math.floor((parseInt(E(s.toString()))+parseInt(d[u]))/M).toString();if(p)R.push(s);s=I}}
